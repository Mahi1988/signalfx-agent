<!--- GENERATED BY gomplate from scripts/docs/monitor-page.md.tmpl --->

# openshift-cluster

Collects cluster-level metrics from the
Kubernetes API server.  It uses the _watch_ functionality of the K8s API
to listen for updates about the cluster and maintains a cache of metrics
that get sent on a regular interval.

Since the agent is generally running in multiple places in a K8s cluster and
since it is generally more convenient to share the same configuration across
all agent instances, this monitor by default makes use of a leader election
process to ensure that it is the only agent sending metrics in a cluster.
All of the agents running in the same namespace that have this monitor
configured will decide amongst themselves which should send metrics for this
monitor, and the rest will stand by ready to activate if the leader agent
dies.  You can override leader election by setting the config option
`alwaysClusterReporter` to true, which will make the monitor always report
metrics.

This monitor is similar to
[kube-state-metrics](https://github.com/kubernetes/kube-state-metrics), and
sends many of the same metrics, but in a way that is less verbose and better
fitted for the SignalFx backend.


Monitor Type: `openshift-cluster`

[Monitor Source Code](https://github.com/signalfx/signalfx-agent/tree/master/internal/monitors/kubernetes/cluster)

**Accepts Endpoints**: No

**Multiple Instances Allowed**: Yes

## Configuration

| Config option | Required | Type | Description |
| --- | --- | --- | --- |
| `alwaysClusterReporter` | no | `bool` | If `true`, leader election is skipped and metrics are always reported. (**default:** `false`) |
| `namespace` | no | `string` | If specified, only resources within the given namespace will be monitored.  If omitted (blank) all supported resources across all namespaces will be monitored. |
| `useNodeName` | no | `bool` | If set to true, the Kubernetes node name will be used as the dimension to which to sync properties about each respective node.  This is necessary if your cluster's machines do not have unique machine-id values, as can happen when machine images are improperly cloned. (**default:** `false`) |
| `kubernetesAPI` | no | `object (see below)` | Config for the K8s API client |
| `nodeConditionTypesToReport` | no | `list of strings` | A list of node status condition types to report as metrics.  The metrics will be reported as datapoints of the form `kubernetes.node_<type_snake_cased>` with a value of `0` corresponding to "False", `1` to "True", and `-1` to "Unknown". (**default:** `[Ready]`) |


The **nested** `kubernetesAPI` config object has the following fields:

| Config option | Required | Type | Description |
| --- | --- | --- | --- |
| `authType` | no | `string` | How to authenticate to the K8s API server.  This can be one of `none` (for no auth), `tls` (to use manually specified TLS client certs, not recommended), or `serviceAccount` (to use the standard service account token provided to the agent pod). (**default:** `serviceAccount`) |
| `skipVerify` | no | `bool` | Whether to skip verifying the TLS cert from the API server.  Almost never needed. (**default:** `false`) |
| `clientCertPath` | no | `string` | The path to the TLS client cert on the pod's filesystem, if using `tls` auth. |
| `clientKeyPath` | no | `string` | The path to the TLS client key on the pod's filesystem, if using `tls` auth. |
| `caCertPath` | no | `string` | Path to a CA certificate to use when verifying the API server's TLS cert.  Generally this is provided by K8s alongside the service account token, which will be picked up automatically, so this should rarely be necessary to specify. |




## Metrics

The following table lists the metrics available for this monitor. Metrics that are marked as Included are standard metrics and are monitored by default.

| Name | Type | Included | Description |
| ---  | ---  | ---    | ---         |
| `openshift.clusterquota.cpu.hard` | gauge |  | Hard limit for number of cpu across all namespaces |
| `openshift.clusterquota.cpu.used` | gauge |  | Consumed number of cpu across all namespaces |
| `openshift.clusterquota.memory.hard` | gauge |  | Hard limit for amount of memory across all namespaces |
| `openshift.clusterquota.memory.used` | gauge |  | Consumed amount of memory across all namespaces |
| `openshift.clusterquota.pods.hard` | gauge |  | Hard limit for number of pods across all namespaces |
| `openshift.clusterquota.pods.used` | gauge |  | Consumed number of pods across all namespaces |
| `openshift.clusterquota.services.hard` | gauge |  | Hard limit for number of services across all namespaces |
| `openshift.clusterquota.services.used` | gauge |  | Consumed number of services across all namespaces |
| `openshift.clusterquota.persistentvolumeclaims.hard` | gauge |  | Hard limit for number of persistentvolumeclaims across all namespaces |
| `openshift.clusterquota.persistentvolumeclaims.used` | gauge |  | Consumed number of persistentvolumeclaims across all namespaces |
| `openshift.clusterquota.services.nodeports.hard` | gauge |  | Hard limit for number of services.nodeports across all namespaces |
| `openshift.clusterquota.services.nodeports.used` | gauge |  | Consumed number of services.nodeports across all namespaces |
| `openshift.clusterquota.services.loadbalancers.hard` | gauge |  | Hard limit for number of services.loadbalancers across all namespaces |
| `openshift.clusterquota.services.loadbalancers.used` | gauge |  | Consumed number of services.loadbalancers across all namespaces |
| `openshift.appliedclusterquota.cpu.hard` | gauge |  | Hard limit for number of cpu by namespace |
| `openshift.appliedclusterquota.cpu.used` | gauge |  | Consumed number of cpu by namespace |
| `openshift.appliedclusterquota.memory.hard` | gauge |  | Hard limit for amount of memory by namespace |
| `openshift.appliedclusterquota.memory.used` | gauge |  | Consumed amount of memory by namespace |
| `openshift.appliedclusterquota.pods.hard` | gauge |  | Hard limit for number of pods by namespace |
| `openshift.appliedclusterquota.pods.used` | gauge |  | Consumed number of pods by namespace |
| `openshift.appliedclusterquota.services.hard` | gauge |  | Hard limit for number of services by namespace |
| `openshift.appliedclusterquota.services.used` | gauge |  | Consumed number of services by namespace |
| `openshift.appliedclusterquota.persistentvolumeclaims.hard` | gauge |  | Hard limit for number of persistentvolumeclaims by namespace |
| `openshift.appliedclusterquota.persistentvolumeclaims.used` | gauge |  | Consumed number of persistentvolumeclaims by namespace |
| `openshift.appliedclusterquota.services.nodeports.hard` | gauge |  | Hard limit for number of services.nodeports by namespace |
| `openshift.appliedclusterquota.services.nodeports.used` | gauge |  | Consumed number of services.nodeports by namespace |
| `openshift.appliedclusterquota.services.loadbalancers.hard` | gauge |  | Hard limit for number of services.loadbalancers by namespace |
| `openshift.appliedclusterquota.services.loadbalancers.used` | gauge |  | Consumed number of services.loadbalancers by namespace |



## Dimensions

The following dimensions may occur on metrics emitted by this monitor.  Some
dimensions may be specific to certain metrics.

| Name | Description |
| ---  | ---         |
| `metric_source` | This is always set to `openshift` |



